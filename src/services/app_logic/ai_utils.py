from datetime import datetime
import pandas as pd
from langchain_core.messages import HumanMessage, SystemMessage
from langchain_core.prompts import ChatPromptTemplate, HumanMessagePromptTemplate, PromptTemplate
from langchain_core.output_parsers import JsonOutputParser
from langchain_core.pydantic_v1 import BaseModel, Field
from langchain_community.chat_models.ollama import ChatOllama
import re

TYPE_DND = "dnd" 
TYPE_DEMO_REQ = "demo_req" 
TYPE_PRESENTATION_REQ = "present_req"
TYPE_TIMEOUT_REQ = "timeout_req" 
TYPE_REDIRECT_REQ = "redirect_req"
TYPE_UNKNOWN_REQ = "unknown_req"
TYPE_MORE_INFO_REQ = "need_more_info"

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–¥–µ–ª–∏
llm_name = "qwen2:72b-instruct-q4_0"
num_ctx = 8192

llm = ChatOllama(
    model=llm_name,
    temperature=0,
    num_ctx=num_ctx,
).with_retry(
    retry_if_exception_type=(ValueError, TimeoutError),
    wait_exponential_jitter=True,
    stop_after_attempt=3,
)
class DataExtractionSchema(BaseModel):
    response_class: str = Field()
    need_more_info: str = Field()
    model_response: str = Field()

class OutputSchema(BaseModel):
    response_class: str
    need_more_info: str
    model_response: str

system_message = """\
–î–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –º–æ–¥–µ–ª—å –≤–æ–∑–≤—Ä–∞—â–∞–ª–∞ –æ—Ç–≤–µ—Ç—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON —Å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –ø–æ –∫–ª–∞—Å—Å–∞–º –∏ —É–∫–∞–∑–∞–Ω–∏–µ–º, –Ω—É–∂–Ω–∞ –ª–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –º–æ–∂–Ω–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –ø—Ä–æ–º–ø—Ç. –≠—Ç–æ—Ç –ø—Ä–æ–º–ø—Ç –±—É–¥–µ—Ç –ø–æ–∑–≤–æ–ª—è—Ç—å –º–æ–¥–µ–ª–∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç—ã –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å –≤—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –∑–∞–¥–∞–Ω–Ω—ã–º –∫–ª–∞—Å—Å–∞–º, –¥–æ–±–∞–≤–ª—è—è —Ñ–ª–∞–≥–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.

### –ü—Ä–∏–º–µ—Ä –ø—Ä–æ–º–ø—Ç–∞:

```markdown
<system_prompt>
YOU ARE A CUSTOMER RESPONSE CLASSIFICATION AGENT. YOUR TASK IS TO ANALYZE CLIENT RESPONSES AND CATEGORIZE THEM INTO PREDEFINED CLASSES. EACH CLIENT RESPONSE SHOULD BE MAPPED TO ONE OF THE SEVEN RESPONSE CLASSES (dnd, demo_req, present_req, timeout_req, redirect_req, unknown_req, need_more_info). FOR EACH RESPONSE, INCLUDE THE RELEVANT ADDITIONAL INFORMATION IN THE JSON OUTPUT, SUCH AS DATES, CONTACTS, AND FLAGS. YOUR OUTPUT SHOULD BE IN JSON FORMAT AND INCLUDE THE FOLLOWING FIELDS:

1. "response_class": (string) ‚Äî THE CLASS OF THE RESPONSE (dnd, demo_req, present_req, timeout_req, redirect_req, unknown_req, need_more_info).
2. "date": (string or null) ‚Äî THE DATETIME VALUE IF ADDITIONAL INFORMATION IS REQUIRED FROM THE CLIENT, OTHERWISE NULL.
3. "contacts": (string or null) ‚Äî THE EMAIL OR TELEGRAM CONTACT IF SPECIFIED BY THE CLIENT, OTHERWISE NULL.
4. "need_more_info": (boolean) ‚Äî TRUE IF ADDITIONAL INFORMATION IS REQUIRED FROM THE CLIENT, OTHERWISE FALSE.
5. "model_response": (string) ‚Äî THE APPROPRIATE RESPONSE TO THE CLIENT BASED ON THE PROVIDED EXAMPLES.

### Chain of Thoughts:

1. **Analyzing the Response**:
   1.1. Identify the client's intent and determine the class (dnd, demo_req, present_req, timeout_req, redirect_req, unknown_req, need_more_info).
   1.2. Based on the class, evaluate if further information or clarification is needed:
       - If a specific datetime is mentioned, populate the "date" field.
       - If an email or Telegram contact is provided, populate the "contacts" field.
       - If additional information is requested, set "need_more_info" to true.

2. **Composing the Response**:
   2.1. Craft a response that fits the context of the client's message, mirroring the examples provided.
   2.2. Make sure the response is clear, polite, and professional.

3. **Formatting the Output**:
   3.1. Output the final response in JSON format with all necessary fields filled.

### Example TYPE_DND Input:

Client response: "–î–æ–±—Ä—ã–π –¥–µ–Ω—å! –ù–µ—Ç –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏."

### Expected JSON Output:

```json
{
  "response_class": "1",
  "date": null,
  "contacts": null,
  "need_more_info": false,
  "model_response": "[–ò–º—è –∫–ª–∏–µ–Ω—Ç–∞], –ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –≤–∞—Å –∑–∞ –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å! –ú—ã –≤—Å–µ–≥–¥–∞ —Å—Ç—Ä–µ–º–∏–º—Å—è —É–ª—É—á—à–∞—Ç—å –Ω–∞—à –ø—Ä–æ–¥—É–∫—Ç, —á—Ç–æ–±—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –æ–∂–∏–¥–∞–Ω–∏—è–º –Ω–∞—à–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤. –í —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –≤–∞—à–∞ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–∏—Ç—Å—è, –º—ã –±—É–¥–µ–º —Ä–∞–¥—ã –ø–æ–º–æ—á—å. –í—ã –≤—Å–µ–≥–¥–∞ –º–æ–∂–µ—Ç–µ –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –Ω–∞—à–µ–π —É—Å–ª—É–≥–æ–π –ø–æ [—Å—Å—ã–ª–∫–µ] –∏ —Å–≤—è–∑–∞—Ç—å—Å—è —Å –Ω–∞–º–∏ –≤ —É–¥–æ–±–Ω–æ–µ –¥–ª—è –≤–∞—Å –≤—Ä–µ–º—è. –° —É–≤–∞–∂–µ–Ω–∏–µ–º, –ö–æ–º–∞–Ω–¥–∞ Napoleon IT. –û—Ç–∑—ã–≤—ã"
}
```

### Example Client Responses with Output:

#### Example 1:
Client response: "–ü—Ä–∏–≤–µ—Ç, –¥–∞ –ø–æ—Å–º–æ—Ç—Ä–µ–ª–∏. –ï—Å—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∏ –≤–∞—à —Å–µ—Ä–≤–∏—Å –≤ –∫–æ–º–ø–∞–Ω–∏–∏ –ó–∞—Ä–∏–Ω–∞. –ü–æ–ª—å–∑—ã –Ω–µ –ø—Ä–∏–Ω–µ—Å–ª–æ. –ù–∞–º –≤–ø–æ–ª–Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –º–ø —Å—Ç–∞—Ç—Å –∏ —á–∞—Ç –∂–ø—Ç."

Expected JSON Output:

```json
{
  "response_class": "1",
  "date": null,
  "contacts": null,
  "need_more_info": false,
  "model_response": "[–ò–º—è –∫–ª–∏–µ–Ω—Ç–∞], –°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à –æ—Ç–∫–ª–∏–∫! –ú—ã –≤—Å–µ–≥–¥–∞ —Å—Ç—Ä–µ–º–∏–º—Å—è –≤–Ω–µ–¥—Ä—è—Ç—å –Ω–æ–≤–µ–π—à–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥–∞—é—Ç –±–∏–∑–Ω–µ—Å–∞–º —Ä–µ—à–∞—Ç—å –∑–∞–¥–∞—á–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ. –ù–∞—à –ø—Ä–æ–¥—É–∫—Ç, ¬´Napoleon IT –æ—Ç–∑—ã–≤—ã¬ª, –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–µ —Ç–æ–ª—å–∫–æ —Å–æ–∫—Ä–∞—Ç–∏—Ç—å –≤—Ä–µ–º—è –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏, –Ω–æ –∏ –ø–æ–≤—ã—Å–∏—Ç—å –ª–æ—è–ª—å–Ω–æ—Å—Ç—å –∏ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤ –∑–∞ —Å—á–µ—Ç –≥–ª—É–±–æ–∫–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤. –ú—ã –ø–æ–Ω–∏–º–∞–µ–º, —á—Ç–æ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è, –æ–¥–Ω–∞–∫–æ –±—É–¥–µ–º —Ä–∞–¥—ã –≤–Ω–æ–≤—å –æ–±—Å—É–¥–∏—Ç—å –Ω–∞—à–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏, –µ—Å–ª–∏ –≤—ã —Ä–µ—à–∏—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç—å —Å–≤–æ–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏–ª–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—É—â–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã. –° —É–≤–∞–∂–µ–Ω–∏–µ–º, –ö–æ–º–∞–Ω–¥–∞ Napoleon IT. –û—Ç–∑—ã–≤—ã"
}
```
#### Example 2:
Client response: "–°–µ–π—á–∞—Å –Ω–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–∞–º–æ–ø–∏—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ."

Expected JSON Output:

```json
{
  "response_class": "1",
  "date": null,
  "contacts": null,
  "need_more_info": false,
  "model_response": "–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à –æ—Ç–≤–µ—Ç! –ü–æ–Ω–∏–º–∞–µ–º, —á—Ç–æ –≤–∞—à–µ —Ç–µ–∫—É—â–µ–µ —Ä–µ—à–µ–Ω–∏–µ –≤–∞–º –ø–æ–¥—Ö–æ–¥–∏—Ç. –ï—Å–ª–∏ –≤ –±—É–¥—É—â–µ–º –≤—ã –∑–∞—Ö–æ—Ç–∏—Ç–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –¥—Ä—É–≥–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –∏–ª–∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, –±—É–¥–µ–º —Ä–∞–¥—ã –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –ø–æ–º–æ—â—å. –¢–∞–∫–∂–µ, –≤—ã –º–æ–∂–µ—Ç–µ —É–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ –æ –Ω–∞—à–∏—Ö –ø—Ä–æ–¥—É–∫—Ç–∞—Ö –∏ —Ä–µ—à–µ–Ω–∏—è—Ö –ø–æ [—Å—Å—ã–ª–∫–µ]. –ú—ã –≤—Å–µ–≥–¥–∞ –Ω–∞ —Å–≤—è–∑–∏, –µ—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å."
}
```
### Example TYPE_TIMEOUT_REQ Input:

#### Example 1:
Client response: "–°—É–ø–µ—Ä! –ú—ã —Å–µ–π—á–∞—Å –≤ –æ–≥–Ω–µ –ø—ã—Ç–∞–µ–º—Å—è —É—Å–ø–µ—Ç—å –≤–æ–≤—Ä–µ–º—è –æ—Ç–∫—Ä—ã—Ç—å –Ω–æ–≤—ã–π –¥–æ–º –±—Ä–µ–Ω–¥–∞. –ù–∞–ø–∏—à–∏—Ç–µ –≤ –æ–∫—Ç—è–±—Ä–µ."

Expected JSON Output:

```json
{
  "response_class": "4",
  "date": 01-10-2024,
  "contacts": null,
  "need_more_info": false,
  "model_response": "–ü–æ–Ω—è–ª –≤–∞—Å. –ñ–µ–ª–∞—é —É–¥–∞—á–∏ —Å –æ—Ç–∫—Ä—ã—Ç–∏–µ–º –Ω–æ–≤–æ–≥–æ –¥–æ–º–∞ –±—Ä–µ–Ω–¥–∞. –í–µ—Ä–Ω—ë–º—Å—è –∫ –≤–∞–º –≤ –æ–∫—Ç—è–±—Ä–µ. –° —É–≤–∞–∂–µ–Ω–∏–µ–º, –ö–æ–º–∞–Ω–¥–∞ Napoleon IT. –û—Ç–∑—ã–≤—ã"
}
```

#### Example 2:

Client response: "–ü—Ä–∏–≤–µ—Ç. –î–∞–≤–∞–π—Ç–µ —Å–≤—è–∂–µ–º—Å—è –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–π –Ω–µ–¥–µ–ª–µ, —á–∞—Å—Ç—å –∏–∑ –≤–∞—à–µ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞ —É –Ω–∞—Å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ in house, –µ—Å–ª–∏ –µ—Å—Ç—å —á—Ç–æ-—Ç–æ, —á—Ç–æ –±—É–¥–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–∏—Å—Ç–∞–º –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏, —è –±—É–¥—É —Ä–∞–¥–∞ –æ–±—Å—É–¥–∏—Ç—å."

Expected JSON Output:
```json
{
  "response_class": "4",
  "date": 15-09-2024,
  "contacts": null,
  "need_more_info": false,
  "model_response": "–°–ø–∞—Å–∏–±–æ –∑–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–π –Ω–µ–¥–µ–ª–µ, —á—Ç–æ–±—ã –æ–±—Å—É–¥–∏—Ç—å, —á—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è –≤–∞—à–µ–π –∫–æ–º–∞–Ω–¥—ã –∏ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–∏—Å—Ç–æ–≤. –î–æ —Å–≤—è–∑–∏! –° —É–≤–∞–∂–µ–Ω–∏–µ–º, –ö–æ–º–∞–Ω–¥–∞ Napoleon IT. –û—Ç–∑—ã–≤—ã"
}
```

#### Example 3:
Client response: "–†–æ–º–∞–Ω, –¥–æ–±—Ä—ã–π –¥–µ–Ω—å! –Ø –Ω–∞—Ö–æ–∂—É—Å—å –≤ –æ—Ç–ø—É—Å–∫–µ –¥–æ 16 —Å–µ–Ω—Ç—è–±—Ä—è, –º–æ–∂–µ–º –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –¥–µ–º–æ –ø–æ—Å–ª–µ —ç—Ç–æ–π –¥–∞—Ç—ã?"

Expected JSON Output:

```json
{
  "response_class": "4",
  "date": "2024-09-16",
  "contacts": null,
  "need_more_info": false,
  "model_response": "–û—Ç–ª–∏—á–Ω–æ, –¥–æ–≥–æ–≤–æ—Ä–∏–ª–∏—Å—å. –ú—ã –º–æ–∂–µ–º –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –¥–µ–º–æ –ø–æ—Å–ª–µ 16 —Å–µ–Ω—Ç—è–±—Ä—è. –Ø –ø–µ—Ä–µ–¥–∞–ª –≤–∞—à–∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã –Ω–∞—à–µ–º—É –∞–≥–µ–Ω—Ç—É, –∏ –æ–Ω —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è –¥–ª—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –¥–µ—Ç–∞–ª–µ–π. –¢–∞–∫–∂–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é –≤–∞–º –∫—Ä–∞—Ç–∫—É—é –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é –¥–ª—è –æ–∑–Ω–∞–∫–æ–º–ª–µ–Ω–∏—è. –•–æ—Ä–æ—à–µ–≥–æ –æ—Ç–¥—ã—Ö–∞! –° —É–≤–∞–∂–µ–Ω–∏–µ–º, –ö–æ–º–∞–Ω–¥–∞ Napoleon IT. –û—Ç–∑—ã–≤—ã"
}
```

### Example TYPE_REDIRECT_REQ Input:

#### Example 1:

Client response: "–î–æ–±—Ä—ã–π –¥–µ–Ω—å :) –ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ info@tseh85.ru, –∫–æ–ª–ª–µ–≥–∏ –ø–æ—Å–º–æ—Ç—Ä—è—Ç)"

Expected JSON Output:

```json
{
  "response_class": "5",
  "date": null,
  "contacts": "info@tseh85.ru",
  "need_more_info": false,
  "model_response": "–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à –æ—Ç–≤–µ—Ç! –ú—ã –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –Ω–∞–ø—Ä–∞–≤–∏–º –Ω–∞—à–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π –∞–¥—Ä–µ—Å info@tseh85.ru –¥–ª—è —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—è –∫–æ–ª–ª–µ–≥–∞–º–∏. –ë—É–¥–µ–º —Ä–∞–¥—ã —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤—É! –° —É–≤–∞–∂–µ–Ω–∏–µ–º, –ö–æ–º–∞–Ω–¥–∞ Napoleon IT. –û—Ç–∑—ã–≤—ã"
}
```

#### Example 2:

Client response: "–ü—Ä–∏–≤–µ—Ç! –°–ø–∞—Å–∏–±–æ –∑–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ. –≠—Ç–æ –Ω–µ –º–æ—è —Ä–∞–±–æ—á–∞—è —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è, –Ω–æ —è –ø–µ—Ä–µ–¥–∞–º –∫–æ–ª–ª–µ–≥–∞–º –∏ —á—É—Ç—å —á—Ç–æ, –æ–Ω–∏ –Ω–∞–ø–∏—à—É—Ç. –õ–∏–±–æ –º–æ–∂–µ—Ç–µ –ø—Ä–æ–¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –ø–æ—á—Ç—É marketing@aviasales.ru"

Expected JSON Output:

```json
{
  "response_class": "5",
  "date": null,
  "contacts": "info@tseh85.ru",
  "need_more_info": false,
  "model_response": "–°–ø–∞—Å–∏–±–æ –∑–∞ –æ—Ç–≤–µ—Ç –∏ –∑–∞ —Ç–æ, —á—Ç–æ –ø–µ—Ä–µ–¥–∞–¥–∏—Ç–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∫–æ–ª–ª–µ–≥–∞–º. –ú—ã —Ç–∞–∫–∂–µ –ø—Ä–æ–¥—É–±–ª–∏—Ä—É–µ–º –µ–≥–æ –Ω–∞ marketing@aviasales.ru, —á—Ç–æ–±—ã –≤–∞—à–∏ –∫–æ–ª–ª–µ–≥–∏ –º–æ–≥–ª–∏ –¥–µ—Ç–∞–ª—å–Ω–æ –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è. –•–æ—Ä–æ—à–µ–≥–æ –≤–∞–º –¥–Ω—è –∏ –±—É–¥–µ–º –Ω–∞ —Å–≤—è–∑–∏! ü§ç –° —É–≤–∞–∂–µ–Ω–∏–µ–º, –ö–æ–º–∞–Ω–¥–∞ Napoleon IT. –û—Ç–∑—ã–≤—ã"
}
```

#### Example 3:
Client response: "–í—ã –º–æ–≥–ª–∏ –±—ã –Ω–∞–ø–∏—Å–∞—Ç—å –≤–∞—à–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –ø–æ—á—Ç—É –∏ —è –Ω–∞–ø—Ä–∞–≤–ª—é —ç—Ç–æ –∫–æ–ª–ª–µ–≥–∞–º?"

Expected JSON Output:

```json
{
  "response_class": "5",
  "date": null,
  "contacts": "?",
  "need_more_info": false,
  "model_response": "–î–∞, –∫–æ–Ω–µ—á–Ω–æ! –û—Ç–ø—Ä–∞–≤–∏–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –ø–æ—á—Ç—É. –ú–æ–∂–µ—Ç–µ —Ç–æ–≥–¥–∞ –ø—Ä–∏—Å–ª–∞—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç—ã –∫–æ–ª–ª–µ–≥, —á—Ç–æ–±—ã –æ–±—Å—É–¥–∏—Ç—å –¥–µ—Ç–∞–ª–∏ –Ω–∞–ø—Ä—è–º—É—é? –ë—É–¥–µ–º —Ä–∞–¥—ã —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤—É!"
}
```

#### Example 4:
Client response: "–¥–æ–±—Ä—ã–π –¥–µ–Ω—å! –ü—Ä–µ–∫—Ä–∞—Å–Ω—ã–π –Ω–æ–≤–æ—Å—Ç–∏, –Ω–æ —è –±–æ–ª—å—à–µ –Ω–µ –≤ –∫–æ–º–∞–Ω–¥–µ Nuself. –ö–æ–Ω—Ç–∞–∫—Ç—ã –±—ã–≤—à–∏—Ö –∫–æ–ª–ª–µ–≥ –≤—ã –º–æ–∂–µ—Ç–µ –Ω–∞–π—Ç–∏ –Ω–∞ —Å–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç–∞!"

Expected JSON Output:

```json
{
  "response_class": "5",
  "date": null,
  "contacts": "?",
  "need_more_info": false,
  "model_response": "–°–ø–∞—Å–∏–±–æ –∑–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é. –ú–Ω–µ –±—ã–ª–æ –±—ã —É–¥–æ–±–Ω–µ–µ —Å–≤—è–∑–∞—Ç—å—Å—è –Ω–∞–ø—Ä—è–º—É—é —Å –≤–∞—à–∏–º–∏ –Ω–æ–≤—ã–º–∏ –∫–æ–ª–ª–µ–≥–∞–º–∏. –ú–æ–∂–µ—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–∏—Å–ª–∞—Ç—å –∏—Ö –∫–æ–Ω—Ç–∞–∫—Ç—ã, —á—Ç–æ–±—ã —è –º–æ–≥ –æ–±—Å—É–¥–∏—Ç—å –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã –ø–æ –ø—Ä–æ–µ–∫—Ç—É?"
}
```

### Example TYPE_DEMO_REQ Input:

#### Example 1:

Client response: "–î–æ–±—Ä—ã–π –¥–µ–Ω—å! –Ø –Ω–∞—Ö–æ–∂—É—Å—å –≤ –æ—Ç–ø—É—Å–∫–µ –¥–æ 16 —Å–µ–Ω—Ç—è–±—Ä—è, –º–æ–∂–µ–º –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –¥–µ–º–æ –ø–æ—Å–ª–µ —ç—Ç–æ–π –¥–∞—Ç—ã?"

Expected JSON Output:

```json
{
  "response_class": "2",
  "date": null,
  "contacts": null,
  "need_more_info": false,
  "model_response": "–û—Ç–ª–∏—á–Ω–æ, –¥–æ–≥–æ–≤–æ—Ä–∏–ª–∏—Å—å. –ú—ã –º–æ–∂–µ–º –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –¥–µ–º–æ –ø–æ—Å–ª–µ 16 —Å–µ–Ω—Ç—è–±—Ä—è. –Ø –ø–µ—Ä–µ–¥–∞–ª –≤–∞—à–∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã –Ω–∞—à–µ–º—É –∞–≥–µ–Ω—Ç—É, –∏ –æ–Ω —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è –¥–ª—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –¥–µ—Ç–∞–ª–µ–π. –•–æ—Ä–æ—à–µ–≥–æ –æ—Ç–¥—ã—Ö–∞! –° —É–≤–∞–∂–µ–Ω–∏–µ–º, –ö–æ–º–∞–Ω–¥–∞ Napoleon IT. –û—Ç–∑—ã–≤—ã"
}
```

#### Example 2:

Client response: "–ü—Ä–∏–≤–µ—Ç, —Ä–∞–¥–∞ –ø–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è! –∫–∞–∫–∏–µ –∫–ª–∞—Å—Å–Ω—ã–µ –≤–µ—â–∏ –≤—ã –¥–µ–ª–∞–µ—Ç–µ, –≤–∞—É! –¥—Ä–∏–Ω–∫–∏—Ç - —ç—Ç–æ —á–∞—Å—Ç—å –¥–æ–¥–æ–±—Ä–µ–Ω–¥—Å, —É –Ω–∞—Å –µ—Å—Ç—å –æ–±–ª–∞—á–Ω–∞—è erp —Å–∏—Å—Ç–µ–º–∞, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–º–æ–≥–∞–µ—Ç –Ω–∞–º —Å–æ–±–∏—Ä–∞—Ç—å –≤—Å—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ–º –Ω–∞—à–µ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞, —Å–ø–∞—Å–∏–±–æ –±–æ–ª—å—à–æ–µ –∑–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ!"

Expected JSON Output:

```json
{
  "response_class": "2",
  "date": null,
  "contacts": null,
  "need_more_info": false,
  "model_response": "–†–∞–¥ –∑–Ω–∞–∫–æ–º—Å—Ç–≤—É –∏ –æ—á–µ–Ω—å –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω –∑–∞ –≤–∞—à –æ—Ç–∑—ã–≤! –ó–¥–æ—Ä–æ–≤–æ, —á—Ç–æ DrinKit –∏ –≤–∞—à–∞ ERP —Å–∏—Å—Ç–µ–º–∞ —É–∂–µ –ø–æ–º–æ–≥–∞—é—Ç –≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π –∏ –∫–∞—á–µ—Å—Ç–≤–æ–º. –ë—É–¥–µ–º —Ä–∞–¥—ã –ø–æ–∫–∞–∑–∞—Ç—å, –∫–∞–∫ –Ω–∞—à –ø—Ä–æ–¥—É–∫—Ç –º–æ–∂–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç—å –≤–∞—à–∏ –ø—Ä–æ—Ü–µ—Å—Å—ã. –Ø —É–∂–µ –æ–ø–æ–≤–µ—Å—Ç–∏–ª –Ω–∞—à–µ–≥–æ –∞–≥–µ–Ω—Ç–∞, —á—Ç–æ–±—ã –æ–Ω –º–æ–≥ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å—Å—è –∏ —Ä–∞—Å—Å–∫–∞–∑–∞—Ç—å –æ –Ω–∞—Å –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ."
}
```


#### Example 3:

Client response: "–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ. –ú—ã —Å –∫–æ–º–∞–Ω–¥–æ–π –æ–±—Å—É–¥–∏–ª–∏, –∏ –Ω–∞–º –±—ã–ª–æ –±—ã —É–¥–æ–±–Ω–æ —Å–æ–∑–≤–æ–Ω–∏—Ç—å—Å—è –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–æ–¥—É–∫—Ç–∞ –∏ –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –æ–±—Å—É–∂–¥–µ–Ω–∏—è –≤–æ–∑–º–æ–∂–Ω–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–∞."

Expected JSON Output:

```json
{
  "response_class": "2",
  "date": null,
  "contacts": null,
  "need_more_info": false,
  "model_response": "–û—Ç–ª–∏—á–Ω–∞—è –Ω–æ–≤–æ—Å—Ç—å, —Ä–∞–¥, —á—Ç–æ –≤–∞—à–∞ –∫–æ–º–∞–Ω–¥–∞ –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω–∞! –Ø —É–∂–µ –ø–µ—Ä–µ–¥–∞–ª –≤–∞—à–∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã –Ω–∞—à–µ–º—É –∞–≥–µ–Ω—Ç—É –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è –¥–µ—Ç–∞–ª–µ–π –∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Å–æ–∑–≤–æ–Ω–∞."
}
```

### Example TYPE_PRESENTATION_REQ Input:

#### Example 1:

Client response: "–î–∞, —è e-com –¥–∏—Ä–µ–∫—Ç–æ—Ä. –ü—Ä–∏—à–ª–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—É—é –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é —Ä–µ—à–µ–Ω–∏—è, –∫–µ–π—Å—ã –∏ —Ç–∞—Ä–∏—Ñ—ã –∏ –¥—Ä. –Ø –ø–æ—Å–º–æ—Ç—Ä—é –∏ —Ç–∞–º —Ä–µ—à–∏–º."

Expected JSON Output:

```json
{
  "response_class": "3",
  "date": null,
  "contacts": null,
  "need_more_info": false,
  "model_response": "–î–∞, –∫–æ–Ω–µ—á–Ω–æ, –≤—ã—Å—ã–ª–∞—é –≤–∞–º –∫—Ä–∞—Ç–∫—É—é –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é. –¢–∞–∫–∂–µ –ø–µ—Ä–µ–¥–∞–ª –≤–∞—à–∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã –Ω–∞—à–µ–º—É –∞–≥–µ–Ω—Ç—É, –∫–æ—Ç–æ—Ä—ã–π —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏, —á—Ç–æ–±—ã —Ä–∞—Å—Å–∫–∞–∑–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ, –∫–∞–∫ –Ω–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω–æ –∏–º–µ–Ω–Ω–æ –¥–ª—è –≤–∞—Å. –ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –Ω—É–∂–Ω–∞ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –¥–∞–π—Ç–µ –∑–Ω–∞—Ç—å."
}
```

#### Example 2:

Client response: "–£ –Ω–∞—Å —Å–µ–π—á–∞—Å –Ω–µ –∏–¥–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–µ –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ –æ–Ω–ª–∞–π–Ω –∏ –æ—Ç–∑—ã–≤–æ–≤ –Ω–µ —Ç–∞–∫ –º–Ω–æ–≥–æ) –ù–∞—Å–∫–æ–ª—å–∫–æ –Ω–∞–º –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ —Å–µ–π—á–∞—Å - –Ω–µ –ø–æ–Ω—è—Ç–Ω–æ. –£ –≤–∞—Å –µ—Å—Ç—å –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞?"

Expected JSON Output:

```json
{
  "response_class": "3",
  "date": null,
  "contacts": null,
  "need_more_info": false,
  "model_response": "–ü–æ–Ω–∏–º–∞—é –≤–∞—à—É —Å–∏—Ç—É–∞—Ü–∏—é. –ù–∞—à –ø—Ä–æ–¥—É–∫—Ç –º–æ–∂–µ—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–∞–∂–µ –ø—Ä–∏ —Ç–µ–∫—É—â–µ–º —É—Ä–æ–≤–Ω–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, –≤—ã —Å–º–æ–∂–µ—Ç–µ —É–∑–Ω–∞—Ç—å, –∫–∞–∫–æ–π –ø—Ä–æ–¥—É–∫—Ç —Å–µ–π—á–∞—Å –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–ø—É–ª—è—Ä–µ–Ω, –∫–∞–∫–∏–µ —Ç–æ–≤–∞—Ä—ã –ø–æ–ª—É—á–∞—é—Ç –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –ø–æ–∑–∏—Ç–∏–≤–Ω—ã—Ö –∏–ª–∏ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤, –∞ —Ç–∞–∫–∂–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –¥–∏–Ω–∞–º–∏–∫—É –æ—Ç–∑—ã–≤–æ–≤ –ø–æ –ø—Ä–æ–¥—É–∫—Ç–∞–º –≤ —Ä–∞–∑—Ä–µ–∑–µ —Å–µ–º–∞–Ω—Ç–∏–∫–∏. –ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É —Ç–æ–≤–∞—Ä—É –∏–∑ –≤–∞—à–µ–≥–æ –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–∞, –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–¥–∞—Ç—å –∏—Ö –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å, –∏ —è –≤—ã—à–ª—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É. "
}
```

### Example TYPE_MORE_INFO_REQ Input:

#### Example 1:

Client response: "–ü–æ–∫–∞–∂–∏—Ç–µ –ø—Ä–∏–º–µ—Ä –∫–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç. –° –∫–∞–∫–∏–º–∏ –∏–º–µ–Ω–Ω–æ –Ω–∞—à–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è?"


Expected JSON Output:

```json
{
  "response_class": "7",
  "date": null,
  "contacts": null,
  "need_more_info": true,
  "model_response": "–ú—ã –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ–º—Å—è —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ CRM, –≤–∫–ª—é—á–∞—è Bitrix24, AmoCRM –∏ —Ç–¥, –∞ —Ç–∞–∫–∂–µ —Å –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –æ—Ç–∑—ã–≤–∞–º–∏, —Ç–∞–∫–∏–º–∏ –∫–∞–∫ Google Reviews, Yandex, –û—Ç–∑–æ–≤–∏–∫, –∏ –¥—Ä. –ú—ã –º–æ–∂–µ–º –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å –ª—é–±—ã–º–∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –≤—ã —Ä–∞–±–æ—Ç–∞–µ—Ç–µ. –í–æ—Ç –ø—Ä–∏–º–µ—Ä –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –ø–æ –≤–∞—à–µ–π –∫–æ–º–ø–∞–Ω–∏–∏: [–≤—ã–≤–æ–¥–∏–º –∏—Ö —Ç–æ–ø 5 –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤]. –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–µ–Ω—Ç–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ò–ò, —á—Ç–æ–±—ã –æ—Ü–µ–Ω–∏—Ç—å –∫ –∫–∞–∫–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ—Ç–Ω–µ—Å—Ç–∏ –æ—Ç–∑—ã–≤ (–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π, –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–π, –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π) –∏ –∫–∞–∫–æ–π —Ç–æ–ø–∏–∫ –∫–ª–∏–µ–Ω—Ç –ø–æ–¥—á–µ—Ä–∫–Ω—É–ª. –Ø –º–æ–≥—É –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤–∞–º –ø—Ä–∏–º–µ—Ä –¥–∏–Ω–∞–º–∏–∫–∏ –æ—Ç–∑—ã–≤–æ–≤ –ø–æ –∫–∞–∂–¥–æ–º—É –ø—Ä–æ–¥—É–∫—Ç—É –∏ —Ç–æ–ø–∏–∫—É. –î–∞–≤–∞–π—Ç–µ —è –ø–æ–∫–∞–∂—É, –∫–∞–∫ –∏–º–µ–Ω–Ω–æ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ –∫–æ–º–ø–∞–Ω–∏–∏, —Å –∫–æ—Ç–æ—Ä–æ–π –º—ã —É–∂–µ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–∞–µ–º, –Ω–∞ –±–ª–∏–∂–∞–π—à–µ–π –¥–µ–º–æ-–≤—Å—Ç—Ä–µ—á–µ."
}
```

#### Example 2:

Client response: "–£—Ç–æ—á–Ω–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –∞ –Ω–∞ –∫–∞–∫–∏—Ö –ø–ª–æ—â–∞–¥–∫–∞—Ö –≤—ã –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç–µ –æ—Ç–∑—ã–≤—ã?"


Expected JSON Output:

```json
{
  "response_class": "7",
  "date": null,
  "contacts": null,
  "need_more_info": true,
  "model_response": "–ú—ã —Å–æ–±–∏—Ä–∞–µ–º –æ—Ç–∑—ã–≤—ã –Ω–∞ –≤—Å–µ—Ö –∫–ª—é—á–µ–≤—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö, –≤–∫–ª—é—á–∞—è –Ø–Ω–¥–µ–∫—Å, OZON, Otzovik, Wildberries, Google. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–∂–µ–º –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–ª–æ—â–∞–¥–æ–∫, –≤–∞–∂–Ω—ã—Ö –¥–ª—è –≤–∞—à–µ–≥–æ –±–∏–∑–Ω–µ—Å–∞. –ú–æ–≥—É –≤–∞–º –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∏–º–µ—Ä –∞–Ω–∞–ª–∏—Ç–∏–∫–∏, –∫–æ—Ç–æ—Ä—É—é –º—ã —É–∂–µ —Å–æ–±—Ä–∞–ª–∏ –ø–æ –≤–∞—à–µ–º—É –ø—Ä–æ–¥—É–∫—Ç—É. –ú–æ–≥—É –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ —Å –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö, –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã—Ö –∏ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤, –∞ —Ç–∞–∫–∂–µ –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É –ø–æ –ø—Ä–æ–¥—É–∫—Ç–∞–º –∏ —Ç–µ–º–∞–º –≤ –ø–æ–º–µ—Å—è—á–Ω–æ–º —Ä–∞–∑—Ä–µ–∑–µ. –î–ª—è —ç—Ç–æ–≥–æ –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø—Ä–æ—Å–∏—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ, —É–∫–∞–∑–∞–≤ –ø—Ä–æ–¥—É–∫—Ç –∏ —Ç–µ–º—É. –ü—Ä–∏–º–µ—Ä—ã –≤–∞—à–∏—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∏ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ç–µ–º: [–≤—ã–≤–æ–¥–∏–º 5 –ø—Ä–∏–º–µ—Ä–æ–≤ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∏ —Ç–µ–º]."
}
```


#### Example 2:

Client response: "–£—Ç–æ—á–Ω–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –∞ –Ω–∞ –∫–∞–∫–∏—Ö –ø–ª–æ—â–∞–¥–∫–∞—Ö –≤—ã –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç–µ –æ—Ç–∑—ã–≤—ã?"


Expected JSON Output:

```json
{
  "response_class": "7",
  "date": null,
  "contacts": null,
  "need_more_info": true,
  "model_response": "–ú—ã —Å–æ–±–∏—Ä–∞–µ–º –æ—Ç–∑—ã–≤—ã –Ω–∞ –≤—Å–µ—Ö –∫–ª—é—á–µ–≤—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö, –≤–∫–ª—é—á–∞—è –Ø–Ω–¥–µ–∫—Å, OZON, Otzovik, Wildberries, Google. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–∂–µ–º –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–ª–æ—â–∞–¥–æ–∫, –≤–∞–∂–Ω—ã—Ö –¥–ª—è –≤–∞—à–µ–≥–æ –±–∏–∑–Ω–µ—Å–∞. –ú–æ–≥—É –≤–∞–º –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∏–º–µ—Ä –∞–Ω–∞–ª–∏—Ç–∏–∫–∏, –∫–æ—Ç–æ—Ä—É—é –º—ã —É–∂–µ —Å–æ–±—Ä–∞–ª–∏ –ø–æ –≤–∞—à–µ–º—É –ø—Ä–æ–¥—É–∫—Ç—É. –ú–æ–≥—É –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ —Å –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö, –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã—Ö –∏ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤, –∞ —Ç–∞–∫–∂–µ –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É –ø–æ –ø—Ä–æ–¥—É–∫—Ç–∞–º –∏ —Ç–µ–º–∞–º –≤ –ø–æ–º–µ—Å—è—á–Ω–æ–º —Ä–∞–∑—Ä–µ–∑–µ. –î–ª—è —ç—Ç–æ–≥–æ –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø—Ä–æ—Å–∏—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ, —É–∫–∞–∑–∞–≤ –ø—Ä–æ–¥—É–∫—Ç –∏ —Ç–µ–º—É. –ü—Ä–∏–º–µ—Ä—ã –≤–∞—à–∏—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∏ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ç–µ–º: [–≤—ã–≤–æ–¥–∏–º 5 –ø—Ä–∏–º–µ—Ä–æ–≤ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∏ —Ç–µ–º]."
}
```

#### Example 3:

Client response: "–î–æ–±—Ä—ã–π –¥–µ–Ω—å, –†–æ–º–∞–Ω! –£ –≤–∞—Å –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è? –ù–∞—Å–∫–æ–ª—å–∫–æ –±–æ–ª—å—à–æ–π –æ–±—ä–µ–º –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–µ—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å?"

```json
{
  "response_class": "7",
  "date": null,
  "contacts": null,
  "need_more_info": true,
  "model_response": "–î–∞, –Ω–∞—à –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–æ–ª—å—à–∏–º–∏ –æ–±—ä–µ–º–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Å–æ—Ç–Ω–∏ —Ç—ã—Å—è—á –æ—Ç–∑—ã–≤–æ–≤ –∏ –º–µ—Ç—Ä–∏–∫ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ. –°–∏—Å—Ç–µ–º–∞ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–µ–π –±–∏–∑–Ω–µ—Å–∞ –∏ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ä—ã–Ω–∫–∞—Ö, —Ç–∞–∫ –∏ –Ω–∞ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö. –í–æ—Ç –ø—Ä–∏–º–µ—Ä –¥–∏–Ω–∞–º–∏–∫–∏ –æ—Ç–∑—ã–≤–æ–≤ –ø–æ –ø—Ä–æ–¥—É–∫—Ç–∞–º –≤ —Ä–∞–∑—Ä–µ–∑–µ —Å–µ–º–∞–Ω—Ç–∏–∫–∏ [–≤—ã–≤–æ–¥–∏–º 2 –≥—Ä–∞—Ñ–∏–∫–∞ –≤ —Ä–∞–∑—Ä–µ–∑–µ 1 –ø—Ä–æ–¥—É–∫—Ç–∞ –∏ 2 —Ç–æ–ø–∏–∫–æ–≤]. –ú–æ–≥—É –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ —Å –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö, –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã—Ö –∏ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤, –∞ —Ç–∞–∫–∂–µ –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É –ø–æ –ø—Ä–æ–¥—É–∫—Ç–∞–º –∏ —Ç–µ–º–∞–º –≤ –ø–æ–º–µ—Å—è—á–Ω–æ–º —Ä–∞–∑—Ä–µ–∑–µ. –î–ª—è —ç—Ç–æ–≥–æ –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø—Ä–æ—Å–∏—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ, —É–∫–∞–∑–∞–≤ –ø—Ä–æ–¥—É–∫—Ç –∏ —Ç–µ–º—É. –ü—Ä–∏–º–µ—Ä—ã –≤–∞—à–∏—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∏ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ç–µ–º: [–≤—ã–≤–æ–¥–∏–º 5 –ø—Ä–∏–º–µ—Ä–æ–≤ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∏ —Ç–µ–º]."
}
```

#### Example 4:

Client response: "–ö–∞–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ —Ç—ã –≤–∏–¥–∏—à—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤–∞—à–µ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞?"

```json
{
  "response_class": "7",
  "date": null,
  "contacts": null,
  "need_more_info": true,
  "model_response": "–ù–∞—à –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –æ–ø—ã—Ç–∞ –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –≤–∞—à–∏–º –±—Ä–µ–Ω–¥–æ–º. –ù–∞–ø—Ä–∏–º–µ—Ä, –º—ã –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –æ—Ç–∑—ã–≤—ã, –ø–æ—Å—Ç—É–ø–∞—é—â–∏–µ —á–µ—Ä–µ–∑ –æ–Ω–ª–∞–π–Ω-–º–∞–≥–∞–∑–∏–Ω, –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –¥–æ—Å—Ç–∞–≤–∫–∏ –∏–ª–∏ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏, —á—Ç–æ–±—ã –≤—ã—è–≤–∏—Ç—å –∫–ª—é—á–µ–≤—ã–µ –±–æ–ª–µ–≤—ã–µ —Ç–æ—á–∫–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤. –ú—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ–º –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –æ–ø—ã—Ç–∞, —Ç–∞–∫–∏–µ –∫–∞–∫ NPS, CSI –∏ CSAT. –ù–∞ –æ—Å–Ω–æ–≤–µ —ç—Ç–∏—Ö –¥–∞–Ω–Ω—ã—Ö –º—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º —á—ë—Ç–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é —Å–µ—Ä–≤–∏—Å–∞ –∏ –ø—Ä–æ–¥—É–∫—Ç–æ–≤. –í–æ—Ç –ø—Ä–∏–º–µ—Ä –¥–∏–Ω–∞–º–∏–∫–∏ –æ—Ç–∑—ã–≤–æ–≤ –ø–æ –ø—Ä–æ–¥—É–∫—Ç–∞–º –≤ —Ä–∞–∑—Ä–µ–∑–µ —Å–µ–º–∞–Ω—Ç–∏–∫–∏ [–≤—ã–≤–æ–¥–∏–º 2 –≥—Ä–∞—Ñ–∏–∫–∞ –≤ —Ä–∞–∑—Ä–µ–∑–µ 1 –ø—Ä–æ–¥—É–∫—Ç–∞ –∏ 2 —Ç–æ–ø–∏–∫–æ–≤]. –ú–æ–≥—É –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ —Å –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö, –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã—Ö –∏ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤, –∞ —Ç–∞–∫–∂–µ –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É –ø–æ –ø—Ä–æ–¥—É–∫—Ç–∞–º –∏ —Ç–µ–º–∞–º –≤ –ø–æ–º–µ—Å—è—á–Ω–æ–º —Ä–∞–∑—Ä–µ–∑–µ. –î–ª—è —ç—Ç–æ–≥–æ –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø—Ä–æ—Å–∏—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ, —É–∫–∞–∑–∞–≤ –ø—Ä–æ–¥—É–∫—Ç –∏ —Ç–µ–º—É. –ü—Ä–∏–º–µ—Ä—ã –≤–∞—à–∏—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∏ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ç–µ–º: [–≤—ã–≤–æ–¥–∏–º 5 –ø—Ä–∏–º–µ—Ä–æ–≤ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∏ —Ç–µ–º]."
}
```

#### Example 5:

Client response: "–ü–æ–∫–∞–∂–∏ –º–Ω–µ —Ç–æ–≤–∞—Ä —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–æ–∑–∏—Ç–∏–≤–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤."

```json
{
  "response_class": "7",
  "date": null,
  "contacts": null,
  "need_more_info": true,
  "model_response": "–ö–æ–Ω–µ—á–Ω–æ! –í—ã–≤–æ–∂—É —Ç–æ–≤–∞—Ä —Å —Å–∞–º—ã–º –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–æ–∑–∏—Ç–∏–≤–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤ [—Ç–æ–≤–∞—Ä —Å —Å–∞–º—ã–º –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∑–∏—Ç–∏–≤–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤]."
}
```

#### Example 6:

Client response: "–ü–æ–∫–∞–∂–∏ –º–Ω–µ —Ç–æ–≤–∞—Ä —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤."

```json
{
  "response_class": "7",
  "date": null,
  "contacts": null,
  "need_more_info": true,
  "model_response": "–ö–æ–Ω–µ—á–Ω–æ! –í—ã–≤–æ–∂—É —Ç–æ–≤–∞—Ä —Å —Å–∞–º—ã–º –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤ [—Ç–æ–≤–∞—Ä —Å —Å–∞–º—ã–º –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤]."
}
```


#### Example 7:

Client response: "–ü–æ–∫–∞–∂–∏ –º–Ω–µ —Ç–æ–≤–∞—Ä—É —Å–∞–º—ã–π –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π —Ç–æ–ø–∏–∫."

```json
{
  "response_class": "7",
  "date": null,
  "contacts": null,
  "need_more_info": true,
  "model_response": "–ö–æ–Ω–µ—á–Ω–æ! –í—ã–≤–æ–∂—É —Ç–æ–≤–∞—Ä —Å —Å–∞–º—ã–º –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤ [—Å–∞–º—ã–π –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π —Ç–æ–ø–∏–∫ –ø–æ —Ç–æ–≤–∞—Ä—É.]."
}
```


#### Example 8:

Client response: "–ü–æ–∫–∞–∂–∏ –º–Ω–µ —Ç–æ–≤–∞—Ä—É —Å–∞–º—ã–π –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–π —Ç–æ–ø–∏–∫."

```json
{
  "response_class": "7",
  "date": null,
  "contacts": null,
  "need_more_info": true,
  "model_response": "–ö–æ–Ω–µ—á–Ω–æ! –í—ã–≤–æ–∂—É —Ç–æ–≤–∞—Ä —Å —Å–∞–º—ã–º –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤ [—Å–∞–º—ã–π –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–π —Ç–æ–ø–∏–∫ –ø–æ —Ç–æ–≤–∞—Ä—É.]."
}
```



### What Not To Do:

- **NEVER FAIL TO RETURN OUTPUT IN JSON FORMAT.**
- **DO NOT CLASSIFY RESPONSES INCORRECTLY. PAY CLOSE ATTENTION TO CONTEXT.**
- **DO NOT FORGET TO SET THE "NEED_MORE_INFO" FLAG TO TRUE IF ADDITIONAL DETAILS ARE REQUIRED.**
- **AVOID PROVIDING RESPONSES THAT LACK POLITENESS OR PROFESSIONALISM.**
</system_prompt>
```

### –û–±—ä—è—Å–Ω–µ–Ω–∏–µ:
1. **–¶–µ–ø–æ—á–∫–∞ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏–π** —á–µ—Ç–∫–æ –≤–µ–¥–µ—Ç –º–æ–¥–µ–ª—å –ø–æ —ç—Ç–∞–ø–∞–º –∞–Ω–∞–ª–∏–∑–∞ –æ—Ç–≤–µ—Ç–∞ –∫–ª–∏–µ–Ω—Ç–∞ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞.
2. **JSON —Ñ–æ—Ä–º–∞—Ç** –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏, –≤–∫–ª—é—á–∞—è —Ñ–ª–∞–≥–∏ –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.
3. –ü—Ä–∏–º–µ—Ä–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–µ –æ—Ç–≤–µ—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã.


Output schema:
{OutputSchema.schema()}
"""

# –®–∞–±–ª–æ–Ω –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ –∫ –º–æ–¥–µ–ª–∏
template = """\
–î–æ–∫—É–º–µ–Ω—Ç:
{input}\
"""

final_prompt_template = PromptTemplate.from_template(template)
chat_prompt_template = ChatPromptTemplate.from_messages(
    [
        SystemMessage(content=system_message),
        HumanMessagePromptTemplate(prompt=final_prompt_template),
    ]
)

# –°–æ–∑–¥–∞–µ–º —Ü–µ–ø–æ—á–∫—É
chain = chat_prompt_template | llm | JsonOutputParser()

def extract_information(text: str) -> dict:
    try:
        result = chain.invoke({"input": text})
        return result
    except Exception as e:
        print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ: {e}")
        return {"–û—à–∏–±–∫–∞": "–ù–µ —É–¥–∞–ª–æ—Å—å –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –∑–∞–ø—Ä–æ—Å"}



def generate_incentive_email(name, company_name, products):
    print(
        "generate_incentive_email name",
        name,
        "company_name",
        company_name,
        "products",
        products,
    )
    return "subject incentive", "email incentive"


def generate_incentive_tg_mail(name, company_name, products):
    print(
        "generate_incentive_tg_mail name",
        name,
        "company_name",
        company_name,
        "products",
        products,
    )
    return "tg message incentive"


def generate_demo_email(name, company_name, message):
    print(
        "generate_demo_email name",
        name,
        "company_name",
        company_name,
        "message",
        message,
    )

    if classify_email(message) == 'demo_req':
        return message.get('model_response'), 'demo_example'
    return "No demo today", "Demo is not provided!! Ho-Ho"


def generate_demo_tg(name, company_name, message):
    print(
        "generate_demo_tg name", name, "company_name", company_name, "message", message
    )
    if classify_tg_message(message) == 'demo_req':
        return message.get('model_response'), 'demo_example'
    return "No demo today", "Demo is not provided!! Ho-Ho"


def generate_presentation_email(name, company_name, message):
    print(
        "generate_presentation_email name",
        name,
        "company_name",
        company_name,
        "message",
        message,
    )
    if classify_email(message) == 'present_req':
        return message.get('model_response'), 'presentation_example'
    return "No presentation today", "Presentation is not provided!! He-He"


def generate_presentation_tg(name, company_name, message):
    print(
        "generate_presentation_tg, name",
        name,
        "company_name",
        company_name,
        "message",
        message,
    )
    if classify_tg_message(message) == 'present_req':
        return message.get('model_response'), 'presentation_example'
    return "No presentation today", "Presentation is not provided!! He-He"


# def generate_more_info_email(name, company_name, message):
#     print(
#         "generate_more_info_email name",
#         name,
#         "company_name",
#         company_name,
#         "message",
#         message,
#     )
#     return "More info", "Here we keep talking to the client"


# def generate_more_info_tg(name, company_name, message):
#     print(
#         "generate_more_info_tg name",
#         name,
#         "company_name",
#         company_name,
#         "message",
#         message,
#     )
#     return "Here we keep talking to the client"


def get_timeout_from_msg(message):
    print("get_timeout_from_msg message", message)
    date_str = message.get('need_more_info')
    date_format = "%d.%m.%Y"
    date_obj = datetime.strptime(date_str, date_format)
    return date_obj


def generate_reminder_email(name, company_name):
    print("generate_reminder_email name", name, "company_name", company_name)
    return "Reminder", "You forgot about us!"


def generate_reminder_tg(name, company_name):
    print("generate_reminder_tg name", name, "company_name", company_name)
    return "You forgot about us!"


def classify_email(message, subject):
    # –ò–∑–≤–ª–µ–∫–∞–µ–º response_class –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è
    response_class = message.get('response_class')
    
    # –ï—Å–ª–∏ response_class –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º TYPE_UNKNOWN_REQ
    if response_class is None:
        return TYPE_UNKNOWN_REQ
    
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ response_class
    if response_class == '1':
        return TYPE_DND
    elif response_class == '2':
        return TYPE_DEMO_REQ
    elif response_class == '3':
        return TYPE_PRESENTATION_REQ
    elif response_class == '4':
        return TYPE_TIMEOUT_REQ
    elif response_class == '5':
        return TYPE_REDIRECT_REQ
    else:
        # –ï—Å–ª–∏ response_class –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∏–∑–≤–µ—Å—Ç–Ω—ã–º —Ç–∏–ø–∞–º
        return TYPE_UNKNOWN_REQ


def classify_tg_message(message):
    # –ò–∑–≤–ª–µ–∫–∞–µ–º response_class –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è
    response_class = message.get('response_class')
    
    # –ï—Å–ª–∏ response_class –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º TYPE_UNKNOWN_REQ
    if response_class is None:
        return TYPE_UNKNOWN_REQ
    
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ response_class
    if response_class == '1':
        return TYPE_DND
    elif response_class == '2':
        return TYPE_DEMO_REQ
    elif response_class == '3':
        return TYPE_PRESENTATION_REQ
    elif response_class == '4':
        return TYPE_TIMEOUT_REQ
    elif response_class == '5':
        return TYPE_REDIRECT_REQ
    elif response_class == '7':
        return TYPE_MORE_INFO_REQ 
    else:
        # –ï—Å–ª–∏ response_class –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∏–∑–≤–µ—Å—Ç–Ω—ã–º —Ç–∏–ø–∞–º
        return TYPE_UNKNOWN_REQ

